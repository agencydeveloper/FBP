/*
 * FAB 4.0.0-beta.3 min
 * Copyright (c) 2013-2015 Valentin Allaire <valentin.allaire@sitexw.fr>
 * Released under the MIT license
 * http://bit.ly/2gtlvcd
 */

(function(window,instanceName,className){var FabUtils=function(){var self=this;var options={};this.errors={throwError:function(name,method,type){throw 'Argument '+name+' of method '+method+' is not an '+type},isObject:function(value,name,method){if(typeof value!=='object'||Array.isArray(value)===!0||value===null){this.throwError(name,method,'object')}},isArray:function(value,name,method){if(Array.isArray(value)===!1){this.throwError(name,method,'array')}},isFunction:function(value,name,method){if(typeof value!=='function'){this.throwError(name,method,'function')}},isString:function(value,name,method){if(typeof value!=='string'){this.throwError(name,method,'string')}},isBoolean:function(value,name,method){if(typeof value!=='boolean'){this.throwError(name,method,'boolean')}}};this.options={set:function(optionsList){self.errors.isObject(optionsList,'optionsList','options.set');for(var key in optionsList){options[key]=optionsList[key]} return self},get:function(key){return options[key]}};this.versionToInt=function(version){var versionInt='';for(var i=0;i<3;i++){var block=version[i]||0;if((''+block).length===1){block='0'+block} versionInt+=block} return parseInt(versionInt)}};var FabPlugin=function(){FabUtils.apply(this);var callbackDetected=null;var callbackUndetected=null;this.setDetected=function(callback){callbackDetected=callback;return this};this.callDetected=function(){if(callbackDetected===null){return!1} callbackDetected();callbackDetected=null;return!0};this.setUndetected=function(callback){callbackUndetected=callback;return this};this.callUndetected=function(){if(callbackUndetected===null){return!1} callbackUndetected();callbackUndetected=null;return!0}};var Fab=function(){FabUtils.apply(this);this.options.set({timeout:200,});var version=[4,0,0,'beta',3];var events={};var pluginsClass={};this.getVersion=function(toInt){if(toInt!==!0){return version}else{this.versionToInt(version)}};this.addEvent=function(name,callback){this.errors.isString(name,'name','addEvent');this.errors.isFunction(callback,'callback','addEvent');if(events[name]===undefined){events[name]=[]} events[name].push(callback);return this};this.on=function(detected,callback){this.errors.isBoolean(detected,'detected','on');this.errors.isFunction(callback,'callback','on');return this.addEvent(detected===!0?'detected':'undetected',callback)};this.onDetected=function(callback){this.errors.isFunction(callback,'callback','onDetected');return this.addEvent('detected',callback)};this.onNotDetected=function(callback){this.errors.isFunction(callback,'callback','onNotDetected');return this.addEvent('undetected',callback)};var dispatchEvent=function(name){var eventsList=events[name];if(eventsList!==undefined){for(var i in eventsList){eventsList[i]()}} return this};this.check=function(pluginsList,optionsList){if(pluginsList instanceof Array===!1&&optionsList===undefined){optionsList=pluginsList;pluginsList=undefined} if(pluginsList===undefined){pluginsList=Object.keys(pluginsClass)} if(optionsList===undefined){optionsList={}} this.errors.isArray(pluginsList,'pluginsList','check');this.errors.isObject(optionsList,'optionsList','check');var plugins={};var pluginsLength=pluginsList.length;var pluginsEndLength=0;var end=function(pluginName,detected,force){pluginsEndLength++;if(force===!0||detected===!0||pluginsEndLength===pluginsLength){clearTimeout(timeout);for(var name in plugins){plugins[name].instance.stop()} dispatchEvent(detected===!0?'detected':'undetected')}};if(pluginsLength===0){end('#NoPlugin',!1,!0);return this} for(var i in pluginsList){var name=pluginsList[i];var plugin=plugins[name]={name:name,instance:new(pluginsClass[name]),detected:null,};if(optionsList[name]!==undefined){plugin.instance.options.set(optionsList[name])}(function(end,plugin){plugin.instance.setDetected(function(){plugin.detected=!0;end(plugin.name,!0)}).setUndetected(function(){plugin.detected=!1;end(plugin.name,!1)})})(end,plugin)} for(var pluginName in plugins){plugins[pluginName].instance.start()} var timeout=setTimeout(function(){end('#Timeout',!1,!0)},this.options.get('timeout'));return this};this.registerPlugin=function(pluginClass){this.errors.isFunction(pluginClass,'pluginClass','registerPlugin');this.errors.isString(pluginClass.pluginName,'pluginClass.pluginName','registerPlugin');this.errors.isArray(pluginClass.versionMin,'pluginClass.versionMin','registerPlugin');if(pluginClass.versionMin.length!==3){this.errors.throwError('pluginClass.versionMin','registerPlugin','array with 3 values')} if(pluginsClass[pluginClass.pluginName]===undefined){if(this.versionToInt(version)>=this.versionToInt(pluginClass.versionMin)){pluginsClass[pluginClass.pluginName]=pluginClass;return!0}else{throw 'The plugin '+pluginClass.pluginName+' ('+pluginClass.versionMin.join('.')+') is too recent for this version of Tortoise ('+version.join('.')+')'}}else{throw 'The plugin '+pluginClass.pluginName+' is already registered'} return!1};this.registerPlugin(FabPluginHtml);this.registerPlugin(FabPluginHttp)};Fab.getPluginClass=function(){return FabPlugin};var FabPluginHtml=function(){Fab.getPluginClass().apply(this,arguments);this.options.set({loopTime:50,baitElement:null,baitClass:'pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links',baitStyle:'width:1px!important;height:1px!important;position:absolute!important;left:-10000px!important;top:-1000px!important;',baitParent:null,});var data={};this.start=function(){var self=this;if(this.options.get('baitElement')===null){data.bait=this.createBait({class:this.options.get('baitClass'),style:this.options.get('baitStyle'),});var baitParent=this.options.get('baitParent');if(baitParent===null){window.document.body.appendChild(data.bait)}else{baitParent.appendChild(data.bait)}}else{data.bait=this.options.get('baitElement')} var check=function(){if(self.checkBait(data.bait,!0)===!0){self.callDetected()}};data.loopTimeout=setTimeout(check,1);data.loopInterval=setInterval(check,this.options.get('loopTime'));return this};this.stop=function(){clearInterval(data.loopTimeout);clearInterval(data.loopInterval);var baitParent=this.options.get('baitParent');if(baitParent===null){window.document.body.removeChild(data.bait)}else{baitParent.removeChild(data.bait)} return this};this.createBait=function(options){var bait=window.document.createElement('div');bait.setAttribute('class',options.class);bait.setAttribute('style',options.style);bait.offsetParent;bait.offsetHeight;bait.offsetLeft;bait.offsetTop;bait.offsetWidth;bait.clientHeight;bait.clientWidth;return bait};this.checkBait=function(bait,checkBody){var detected=!1;if(checkBody===!0&&(window.document.body.getAttribute('abp')!==null)||bait.offsetParent===null||bait.offsetHeight===0||bait.offsetLeft===0||bait.offsetTop===0||bait.offsetWidth===0||bait.clientHeight===0||bait.clientWidth===0){detected=!0}else{var baitComputedStyle=window.getComputedStyle(bait);if(baitComputedStyle.getPropertyValue('display')=='none'||baitComputedStyle.getPropertyValue('visibility')=='hidden'){detected=!0}} return detected}};FabPluginHtml.pluginName='html';FabPluginHtml.version=[1,0,0];FabPluginHtml.versionMin=[4,0,0];var FabPluginHttp=function(){Fab.getPluginClass().apply(this,arguments);this.options.set({baitMode:'ajax',baitUrl:'//ads.proboards.com/ad/banner/_adsense_/_adserver/_adview_.ad.json?adzone=top&adsize=300x250&advid={RANDOM}',});var data={};this.start=function(){var self=this;data.end=!1;var baitUrl=this.options.get('baitUrl').replace(/\{RANDOM\}/g,function(){return parseInt(Math.random()*100000000)});this._urlCheck(baitUrl,this.options.get('baitMode'),function(){if(data.end!==!1){return} data.end=!0;self.callDetected()},function(){if(data.end!==!1){return} data.end=!0;self.callUndetected()});return this};this.stop=function(){data.end=!0;return this};this._urlCheck=function(url,mode,cbDetected,cbUndetected){var endSend=!1;var end=function(detected){if(endSend!==!1){return} endSend=!0;if(detected===!0){cbDetected()}else{cbUndetected()}};if(mode==='ajax'){var readyStates=[!1,!1,!1,!1];var status=null;var respond=function(responseForce){if(responseForce!==undefined){end(responseForce)}else{if(status===0){end(!0);return} for(var i=0;i<4;i++){if(readyStates[i]===!1){end(!0);return}} end(!1)}};var xmlHttp=new XMLHttpRequest();xmlHttp.onreadystatechange=function(){readyStates[xmlHttp.readyState-1]=!0;try{status=xmlHttp.status}catch(e){} if(xmlHttp.readyState===4){respond()}};try{xmlHttp.open('GET',url,!0);xmlHttp.send()}catch(e){if(e.result=='2153644038'){respond(!0)}}}else if(mode==='import'){var element=document.createElement('script');element.src=url;element.onerror=function(){end(!0);window.document.body.removeChild(element)};element.onload=function(){end(!1);window.document.body.removeChild(element)};window.document.body.appendChild(element)}else{end(!1)}}};FabPluginHttp.pluginName='http';FabPluginHtml.version=[1,0,0];FabPluginHttp.versionMin=[4,0,0];window[className]=Fab;if(window[instanceName]===undefined){var instance=window[instanceName]=new Fab();window.addEventListener('load',function(){setTimeout(function(){instance.check()},1)},!1)}})(window,'tortoise','Tortoise')
